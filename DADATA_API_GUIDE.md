# üìç –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Dadata API

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–ø–∏—Å–∞–Ω–∏–µ](#–æ–ø–∏—Å–∞–Ω–∏–µ)
2. [–ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –∞–¥—Ä–µ—Å–∞–º](#1-–ø–æ–¥—Å–∫–∞–∑–∫–∏-–ø–æ-–∞–¥—Ä–µ—Å–∞–º)
3. [–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤](#2-—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è-–∞–¥—Ä–µ—Å–æ–≤)
4. [–ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ](#3-–≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)
5. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CDEK](#4-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-cdek)
6. [–ö–æ–¥—ã –∫–∞—á–µ—Å—Ç–≤–∞](#5-–∫–æ–¥—ã-–∫–∞—á–µ—Å—Ç–≤–∞)
7. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ](#6-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–Ω–∞-—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ)

---

## –û–ø–∏—Å–∞–Ω–∏–µ

**Dadata** ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–¥—Ä–µ—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç:

‚úîÔ∏è **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—å –∞–¥—Ä–µ—Å–∞** –Ω–∞ –≤–µ–±-—Ñ–æ—Ä–º–∞—Ö —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ  
‚úîÔ∏è **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å–∞** ‚Äî —Ä–∞–∑–±–∏–≤–∞—Ç—å –ø–æ –ø–æ–ª—è–º (—Ä–µ–≥–∏–æ–Ω, –≥–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞)  
‚úîÔ∏è **–û–ø—Ä–µ–¥–µ–ª—è—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã** –ø–æ –∞–¥—Ä–µ—Å—É –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç  
‚úîÔ∏è **–ü–æ–ª—É—á–∞—Ç—å –∫–æ–¥—ã** –ö–õ–ê–î–†, –§–ò–ê–°, –û–ö–ê–¢–û, –û–ö–¢–ú–û, –ø–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å  
‚úîÔ∏è **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–∞** –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏  

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í —Ñ–∞–π–ª–µ `.env` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–ª—é—á–∏:

```env
DADATA_API_TOKEN=fd97964293967b1cf8455ac41685a7f19a5beb9d
DADATA_SECRET_KEY=98e142de70bde938918f64881a87f80ea81618c6
```

---

## 1. –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –∞–¥—Ä–µ—Å–∞–º

### üéØ Endpoint
```
GET /dadata/suggest/address?query=–ú–æ—Å–∫–≤–∞+–¢–≤–µ—Ä—Å–∫–∞—è
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ
–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ –Ω–∞ —Ñ–æ—Ä–º–µ. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ —Å –ö–õ–ê–î–†, –§–ò–ê–°, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `query` | string | ‚úÖ | –°—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–¥—Ä–µ—Å–∞ |
| `count` | number | ‚ùå | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫ (1-20, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10) |
| `from_bound` | string | ‚ùå | –ù–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å: `country`, `region`, `city`, `settlement`, `street`, `house` |
| `to_bound` | string | ‚ùå | –ö–æ–Ω–µ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å |
| `kladr_id` | string | ‚ùå | –ö–õ–ê–î–†-–∫–æ–¥ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ä–æ–¥—É/—Ä–µ–≥–∏–æ–Ω—É |

### üì§ –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

```json
{
  "success": true,
  "data": {
    "suggestions": [
      {
        "value": "–≥ –ú–æ—Å–∫–≤–∞, —É–ª –¢–≤–µ—Ä—Å–∫–∞—è",
        "unrestricted_value": "125009, –≥ –ú–æ—Å–∫–≤–∞, —É–ª –¢–≤–µ—Ä—Å–∫–∞—è",
        "data": {
          "postal_code": "125009",
          "country": "–†–æ—Å—Å–∏—è",
          "country_iso_code": "RU",
          "region": "–ú–æ—Å–∫–≤–∞",
          "city": "–ú–æ—Å–∫–≤–∞",
          "street": "–¢–≤–µ—Ä—Å–∫–∞—è",
          "street_with_type": "—É–ª –¢–≤–µ—Ä—Å–∫–∞—è",
          "fias_id": "f26b876b-6857-4951-b060-ec6559f04a9a",
          "kladr_id": "7700000000038100",
          "geo_lat": "55.7595568",
          "geo_lon": "37.6123081",
          "qc_geo": 2
        }
      }
    ]
  },
  "message": "–ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–ª—É—á–µ–Ω—ã",
  "count": 1
}
```

### üîπ –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏

#### –¢–æ–ª—å–∫–æ –≥–æ—Ä–æ–¥–∞:
```
GET /dadata/suggest/city?query=–°–∞–Ω–∫—Ç
```

#### –¢–æ–ª—å–∫–æ —É–ª–∏—Ü—ã –≤ –ú–æ—Å–∫–≤–µ:
```
GET /dadata/suggest/address?query=–¢–≤–µ—Ä—Å–∫–∞—è&from_bound=street&to_bound=street&kladr_id=7700000000000
```

---

## 2. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤

### üéØ Endpoint
```
POST /dadata/clean/address
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ
–†–∞–∑–±–∏–≤–∞–µ—Ç –∞–¥—Ä–µ—Å –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø–æ–ª—è–º, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏–Ω–¥–µ–∫—Å, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –∫–æ–¥—ã –ö–õ–ê–î–†/–§–ò–ê–°/–û–ö–ê–¢–û/–û–ö–¢–ú–û.

### üì• –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞

```json
{
  "address": "–º—Å–∫ —Å—É—Ö–æ–Ω—Å–∫–∞—è 11 89"
}
```

### üì§ –û—Ç–≤–µ—Ç

```json
{
  "success": true,
  "data": [
    {
      "source": "–º—Å–∫ —Å—É—Ö–æ–Ω—Å–∫–∞—è 11 89",
      "result": "–≥ –ú–æ—Å–∫–≤–∞, —É–ª –°—É—Ö–æ–Ω—Å–∫–∞—è, –¥ 11, –∫–≤ 89",
      "postal_code": "127642",
      "country": "–†–æ—Å—Å–∏—è",
      "country_iso_code": "RU",
      "region": "–ú–æ—Å–∫–≤–∞",
      "city": "–ú–æ—Å–∫–≤–∞",
      "street": "–°—É—Ö–æ–Ω—Å–∫–∞—è",
      "street_with_type": "—É–ª –°—É—Ö–æ–Ω—Å–∫–∞—è",
      "house": "11",
      "flat": "89",
      "fias_id": "f26b876b-6857-4951-b060-ec6559f04a9a",
      "kladr_id": "7700000000038100",
      "geo_lat": "55.8782557",
      "geo_lon": "37.6577109",
      "qc": 0,
      "qc_complete": 0,
      "qc_house": 2,
      "qc_geo": 0
    }
  ],
  "message": "–ê–¥—Ä–µ—Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω"
}
```

---

## 3. –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3.1. –ü—Ä—è–º–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (–∞–¥—Ä–µ—Å ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)

#### üéØ Endpoint
```
GET /dadata/geocode?address=–ú–æ—Å–∫–≤–∞+–ö—Ä–∞—Å–Ω–∞—è+–ø–ª–æ—â–∞–¥—å+1
```

#### üì§ –û—Ç–≤–µ—Ç

```json
{
  "success": true,
  "data": {
    "address": "–≥ –ú–æ—Å–∫–≤–∞, –ö—Ä–∞—Å–Ω–∞—è –ø–ª, –¥ 1",
    "unrestricted_value": "109012, –≥ –ú–æ—Å–∫–≤–∞, –ö—Ä–∞—Å–Ω–∞—è –ø–ª, –¥ 1",
    "latitude": 55.7539303,
    "longitude": 37.620795,
    "postal_code": "109012",
    "kladr_id": "7700000000000",
    "fias_id": "0c5b2444-70a0-4932-980c-b4dc0d3f02b5",
    "qc_geo": 0
  },
  "message": "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã"
}
```

### 3.2. –û–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Üí –∞–¥—Ä–µ—Å)

#### üéØ Endpoint
```
GET /dadata/reverse-geocode?latitude=55.7558&longitude=37.6173
```

---

## 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CDEK

### üéØ Endpoint
```
GET /dadata/address-info?address=–ú–æ—Å–∫–≤–∞+–¢–≤–µ—Ä—Å–∫–∞—è+12
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–¥—Ä–µ—Å–µ, –≥–æ—Ç–æ–≤—É—é –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ CDEK API.

### üì§ –û—Ç–≤–µ—Ç

```json
{
  "success": true,
  "data": {
    "value": "–≥ –ú–æ—Å–∫–≤–∞, —É–ª –¢–≤–µ—Ä—Å–∫–∞—è, –¥ 12",
    "unrestricted_value": "125009, –≥ –ú–æ—Å–∫–≤–∞, —É–ª –¢–≤–µ—Ä—Å–∫–∞—è, –¥ 12",
    "postal_code": "125009",
    "country_code": "RU",
    "city": "–ú–æ—Å–∫–≤–∞",
    "address": "—É–ª –¢–≤–µ—Ä—Å–∫–∞—è, –¥ 12",
    "latitude": 55.7595,
    "longitude": 37.6123,
    "fias_id": "f26b876b-6857-4951-b060-ec6559f04a9a",
    "kladr_id": "7700000000038100",
    "region": "–ú–æ—Å–∫–≤–∞",
    "region_code": null,
    "city_code": null,
    "qc_geo": 0,
    "qc_complete": 0,
    "full_data": { /* –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ */ }
  },
  "message": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞"
}
```

### üîó –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å CDEK

```javascript
// 1. –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–¥—Ä–µ—Å–µ
const dadataResponse = await fetch(`/dadata/address-info?address=${encodeURIComponent(address)}`);
const { data: addressInfo } = await dadataResponse.json();

// 2. –ù–∞–π—Ç–∏ –∫–æ–¥ –≥–æ—Ä–æ–¥–∞ CDEK
const cdekCityResponse = await fetch(
  `/cdek/location/suggest/cities?name=${encodeURIComponent(addressInfo.city)}`
);
const { data: cities } = await cdekCityResponse.json();
const cityCode = cities[0]?.code;

// 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ CDEK API
const cdekOrder = {
  type: 1,
  tariff_code: 137,
  to_location: {
    code: cityCode,
    city: addressInfo.city,
    postal_code: addressInfo.postal_code,
    address: addressInfo.address,
    latitude: addressInfo.latitude,
    longitude: addressInfo.longitude
  },
  recipient: { /* ... */ },
  packages: [ /* ... */ ]
};
```

---

## 5. –ö–æ–¥—ã –∫–∞—á–µ—Å—Ç–≤–∞

### 5.1. –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥—Ä–µ—Å–∞ (qc)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞? |
|-----|----------|-----------------|
| `0` | –ê–¥—Ä–µ—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω —É–≤–µ—Ä–µ–Ω–Ω–æ | ‚ùå –ù–µ—Ç |
| `1` | –û—Å—Ç–∞–ª–∏—Å—å –ª–∏—à–Ω–∏–µ —á–∞—Å—Ç–∏ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö | ‚úÖ –î–∞ |
| `2` | –ê–¥—Ä–µ—Å –ø—É—Å—Ç–æ–π –∏–ª–∏ –º—É—Å–æ—Ä–Ω—ã–π | ‚ùå –ù–µ—Ç |
| `3` | –ï—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã | ‚úÖ –î–∞ |

### 5.2. –ö–æ–¥ –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏ –∫ —Ä–∞—Å—Å—ã–ª–∫–µ (qc_complete)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ–¥—Ö–æ–¥–∏—Ç? |
|-----|----------|-----------|
| `0` | –ü—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è –ø–æ—á—Ç–æ–≤–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ | ‚úÖ –î–∞ |
| `1` | –ù–µ—Ç —Ä–µ–≥–∏–æ–Ω–∞ | ‚ùå –ù–µ—Ç |
| `2` | –ù–µ—Ç –≥–æ—Ä–æ–¥–∞ | ‚ùå –ù–µ—Ç |
| `3` | –ù–µ—Ç —É–ª–∏—Ü—ã | ‚ùå –ù–µ—Ç |
| `4` | –ù–µ—Ç –¥–æ–º–∞ | ‚ùå –ù–µ—Ç |
| `5` | –ù–µ—Ç –∫–≤–∞—Ä—Ç–∏—Ä—ã (–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —é—Ä.–ª–∏—Ü) | ‚ö†Ô∏è –ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º |
| `6` | –ê–¥—Ä–µ—Å –Ω–µ–ø–æ–ª–Ω—ã–π | ‚ùå –ù–µ—Ç |
| `7` | –ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å | ‚ùå –ù–µ—Ç |
| `8` | –î–æ –ø–æ—á—Ç–æ–≤–æ–≥–æ –æ—Ç–¥–µ–ª–µ–Ω–∏—è | ‚ö†Ô∏è –ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º |
| `9` | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–±–æ—Ä–∞ | ‚ö†Ô∏è –ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º |
| `10` | –î–æ–º–∞ –Ω–µ—Ç –≤ –§–ò–ê–° | ‚ö†Ô∏è –ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º |

### 5.3. –ö–æ–¥ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (qc_geo)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–∞—á–µ—Å—Ç–≤–æ |
|-----|----------|----------|
| `0` | –¢–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| `1` | –ë–ª–∏–∂–∞–π—à–∏–π –¥–æ–º | ‚úÖ –•–æ—Ä–æ—à–æ |
| `2` | –£–ª–∏—Ü–∞ | ‚ö†Ô∏è –°—Ä–µ–¥–Ω–µ |
| `3` | –ù–∞—Å–µ–ª–µ–Ω–Ω—ã–π –ø—É–Ω–∫—Ç | ‚ö†Ô∏è –ü–ª–æ—Ö–æ |
| `4` | –ì–æ—Ä–æ–¥ | ‚ùå –û—á–µ–Ω—å –ø–ª–æ—Ö–æ |
| `5` | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã | ‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ |

### 5.4. –ù–∞–ª–∏—á–∏–µ –¥–æ–º–∞ –≤ –§–ò–ê–° (qc_house)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `2` | –î–æ–º –Ω–∞–π–¥–µ–Ω –≤ –§–ò–ê–° |
| `10` | –î–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –§–ò–ê–° |

---

## 6. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

### 6.1. –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –∞–¥—Ä–µ—Å–∞

```vue
<template>
  <div class="address-autocomplete">
    <input
      v-model="query"
      @input="onInput"
      placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å"
    />
    <ul v-if="suggestions.length">
      <li
        v-for="item in suggestions"
        :key="item.data.fias_id"
        @click="selectAddress(item)"
      >
        {{ item.value }}
      </li>
    </ul>
  </div>
</template>

<script setup>
import { ref } from 'vue';
import { useDebounceFn } from '@vueuse/core';

const query = ref('');
const suggestions = ref([]);

const searchAddress = async (q) => {
  if (q.length < 3) {
    suggestions.value = [];
    return;
  }

  try {
    const response = await fetch(
      `/dadata/suggest/address?query=${encodeURIComponent(q)}`
    );
    const { data } = await response.json();
    suggestions.value = data.suggestions || [];
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∞–¥—Ä–µ—Å–∞:', error);
  }
};

const onInput = useDebounceFn(async () => {
  await searchAddress(query.value);
}, 300);

const selectAddress = (item) => {
  query.value = item.value;
  suggestions.value = [];
  
  // Emit —Å–æ–±—ã—Ç–∏–µ —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  emit('select', {
    address: item.value,
    postal_code: item.data.postal_code,
    city: item.data.city,
    latitude: parseFloat(item.data.geo_lat),
    longitude: parseFloat(item.data.geo_lon),
    fias_id: item.data.fias_id,
    kladr_id: item.data.kladr_id,
  });
};
</script>
```

### 6.2. –ü–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –≥–æ—Ä–æ–¥–∞

```javascript
async function searchCity(query) {
  const response = await fetch(
    `/dadata/suggest/city?query=${encodeURIComponent(query)}`
  );
  const { data } = await response.json();
  
  return data.suggestions.map(item => ({
    name: item.value,
    postal_code: item.data.postal_code,
    fias_id: item.data.fias_id,
    kladr_id: item.data.kladr_id,
  }));
}
```

### 6.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∞–¥—Ä–µ—Å–∞

```javascript
async function validateAddress(address) {
  // –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ–º –∞–¥—Ä–µ—Å
  const response = await fetch('/dadata/clean/address', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ address })
  });
  
  const { data } = await response.json();
  const cleaned = data[0];
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ
  const quality = {
    isGood: cleaned.qc === 0 && cleaned.qc_complete === 0,
    hasCoordinates: cleaned.qc_geo <= 1,
    hasHouse: cleaned.qc_house === 2,
    issues: []
  };
  
  if (cleaned.qc !== 0) {
    quality.issues.push('–ê–¥—Ä–µ—Å —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏');
  }
  if (cleaned.qc_complete !== 0) {
    quality.issues.push('–ê–¥—Ä–µ—Å –Ω–µ–ø–æ–ª–Ω—ã–π –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π');
  }
  if (cleaned.qc_geo > 1) {
    quality.issues.push('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–µ—Ç–æ—á–Ω–æ');
  }
  
  return {
    cleaned,
    quality
  };
}
```

### 6.4. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –ø–æ IP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```javascript
async function detectUserCity() {
  try {
    // –ü–æ–ª—É—á–∞–µ–º IP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)
    const ipResponse = await fetch('https://api.ipify.org?format=json');
    const { ip } = await ipResponse.json();
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≥–æ—Ä–æ–¥ –ø–æ IP
    const dadataResponse = await fetch(
      `/dadata/detect-city?ip=${ip}`
    );
    const { data } = await dadataResponse.json();
    
    if (data.location) {
      return {
        city: data.location.data.city,
        region: data.location.data.region,
        latitude: parseFloat(data.location.data.geo_lat),
        longitude: parseFloat(data.location.data.geo_lon),
      };
    }
  } catch (error) {
    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≥–æ—Ä–æ–¥:', error);
  }
  
  return null;
}
```

### 6.5. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º—ã —Å –∞–¥—Ä–µ—Å–æ–º

```vue
<template>
  <div class="address-form">
    <h3>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</h3>
    
    <!-- –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –≥–æ—Ä–æ–¥–∞ -->
    <AddressAutocomplete
      v-model="form.city"
      type="city"
      placeholder="–ì–æ—Ä–æ–¥"
      @select="onCitySelect"
    />
    
    <!-- –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç —É–ª–∏—Ü—ã (—Ñ–∏–ª—å—Ç—Ä –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≥–æ—Ä–æ–¥—É) -->
    <AddressAutocomplete
      v-model="form.street"
      type="street"
      :kladr-id="form.cityKladrId"
      placeholder="–£–ª–∏—Ü–∞"
      :disabled="!form.cityKladrId"
      @select="onStreetSelect"
    />
    
    <!-- –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –¥–æ–º–∞ -->
    <AddressAutocomplete
      v-model="form.house"
      type="house"
      :kladr-id="form.streetKladrId"
      placeholder="–î–æ–º"
      :disabled="!form.streetKladrId"
      @select="onHouseSelect"
    />
    
    <!-- –ö–≤–∞—Ä—Ç–∏—Ä–∞ -->
    <input
      v-model="form.flat"
      placeholder="–ö–≤–∞—Ä—Ç–∏—Ä–∞"
    />
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—á–µ—Å—Ç–≤–µ –∞–¥—Ä–µ—Å–∞ -->
    <div v-if="addressQuality" class="quality-info">
      <span :class="`quality-${addressQuality.quality}`">
        {{ addressQuality.quality === 'excellent' ? '‚úÖ –ê–¥—Ä–µ—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω' : '‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å' }}
      </span>
      <ul v-if="addressQuality.issues.length">
        <li v-for="issue in addressQuality.issues" :key="issue">
          {{ issue }}
        </li>
      </ul>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue';

const form = ref({
  city: '',
  cityKladrId: '',
  street: '',
  streetKladrId: '',
  house: '',
  flat: '',
  postal_code: '',
  latitude: null,
  longitude: null,
});

const addressQuality = ref(null);

const onCitySelect = (data) => {
  form.value.cityKladrId = data.kladr_id;
  form.value.postal_code = data.postal_code;
};

const onStreetSelect = (data) => {
  form.value.streetKladrId = data.kladr_id;
};

const onHouseSelect = async (data) => {
  form.value.latitude = data.latitude;
  form.value.longitude = data.longitude;
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–∞
  const fullAddress = `${form.value.city}, ${form.value.street}, ${form.value.house}`;
  addressQuality.value = await validateAddress(fullAddress);
};
</script>
```

---

## üìå –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 3-–≥–æ —Å–∏–º–≤–æ–ª–∞** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ debounce** (300-500–º—Å) –ø—Ä–∏ –≤–≤–æ–¥–µ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏
3. **–ö—ç—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ qc-–∫–æ–¥—ã** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–∫–∞–∑–∞ –≤ CDEK
5. **–î–ª—è CDEK –Ω—É–∂–µ–Ω city_code** ‚Äî –ø–æ–ª—É—á–∞–π—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ `/cdek/location/suggest/cities` –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ –≤ Dadata

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–î–∞—Ç–∞:** 2025-10-19  
**–ê–≤—Ç–æ—Ä:** GitHub Copilot
